{
  "version": 3,
  "sources": ["../src/otp.js"],
  "sourcesContent": ["/* eslint-disable prefer-destructuring */\n//generate OTP\nvar phone,\n  OTPverified = false;\nconsole.log('OTP file loaded');\n\n//when the button before the OTP screen is clicked, send the OTP\n\n$('#second-continue').on('click', function () {\n  buttonStatus();\n  $('#resend-otp-button').css('pointer-events', 'none');\n  phone = $('#bi-phone').val();\n  // email = $('#bi-email').val();\n  phone = parseInt(phone);\n  phone = '+91' + phone;\n  //getOTP(phone); //get the OTP for this phone number\n  startTimer(); //start timer for resend OTP function\n});\n\nfunction buttonStatus() {\n  if (!OTPverified) {\n    $('#otp-continue-button').css('pointer-events', 'none');\n    $('#otp-continue-button').addClass('disabled');\n  } else {\n    $('#otp-continue-button').css('pointer-events', 'auto');\n    $('#otp-continue-button').removeClass('disabled');\n  }\n}\nfunction startTimer() {\n  let remainingTimeElement = document.querySelector('#remainingTime'),\n    secondsLeft = 5;\n\n  const Timer = setInterval(() => {\n    if (secondsLeft <= 0) {\n      clearInterval(Timer);\n      $('#resend-otp-button').css('pointer-events', 'auto');\n      $('#resend-otp-button').css('color', 'rgba(87, 14, 64, 1)');\n      $('#resend-otp-button').css('border-bottom', '2px solid rgba(87, 14, 64, 1)');\n    }\n    remainingTimeElement.value = secondsLeft;\n    remainingTimeElement.textContent = '(' + secondsLeft + ')';\n    secondsLeft -= 1;\n  }, 1000);\n}\n\n//common headers between get and verify OTP.\nvar myHeaders = new Headers();\nmyHeaders.append('Content-Type', 'application/json');\nmyHeaders.append('Access-Control-Allow-Origin', 'https://plumhq.com');\nmyHeaders.append('Access-Control-Allow-Credentials', 'true');\n\n//get OTP from API\nasync function getOTP(phone) {\n  var raw = JSON.stringify({\n    phone: phone,\n    channel: 'SMS',\n    key: 'businessOTC',\n  });\n\n  var requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: raw,\n    redirect: 'follow',\n  };\n\n  fetch(\n    'https://api-prod.plumhq.com/api/v2/authentication/phoneVerfication/otp/generate',\n    requestOptions\n  )\n    .then((response) => response.json())\n    .then((result) => saveID(result))\n    .catch((error) => console.log('error'));\n}\n\n//convert response to JSON and saving the ID to a variable\nfunction saveID(result) {\n  id = Object.entries(result);\n  id = id[0][1];\n  console.log(id);\n}\n\n//call verify OTP function on button click\n$('#verify-otp').on('click', function () {\n  $('#otp-continue-button').click();\n  verifyOTP();\n});\n\n//verify OTP\nasync function verifyOTP() {\n  var otp = $('#otp-field').val();\n\n  var raw = JSON.stringify({\n    code: otp,\n    requestId: id,\n    channel: 'SMS',\n  });\n\n  var requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: raw,\n    redirect: 'follow',\n  };\n\n  fetch(\n    'https://api-prod.plumhq.com/api/v2/authentication/phoneVerfication/otp/verify',\n    requestOptions\n  )\n    .then((response) => response.json())\n    .then((result) => verify(result))\n    .catch((error) => errorMessage());\n\n  function verify(result) {\n    var verify = Object.entries(result);\n    verify = verify[0];\n\n    if (verify[0] === 'success') {\n      OTPverified = true;\n      buttonStatus();\n      $('#otp-continue-button').click();\n    } else incorrectOTP();\n  }\n}\n\nfunction incorrectOTP() {\n  errorMessage.innerHTML = 'Incorrect OTP';\n  errorMessage.css('display', 'block');\n  setTimeout(() => {\n    errorMessage.css('display', 'hide');\n  }, '3000');\n}\n\nfunction errorMessage() {\n  errorMessage.innerHTML = 'An error occured.';\n}\n\n$('#resend-otp-button').on('click', function () {\n  getOTP(phone);\n});\n\nvar id;\nvar errorMessage = $('#incorrect-otp');\n"],
  "mappings": "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",
  "names": ["phone", "verify"]
}
